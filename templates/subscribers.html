<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Reporting Dashboard</title>

  <!-- Load Bootstrap 4 -->
  <!-- CSS only -->
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
  <!-- Load Chart JS -->
  <script src='https://cdnjs.cloudflare.com/ajax/libs/Chart.js/1.0.2/Chart.min.js'></script>
  <!-- Load Font Awesome -->
  <script src="https://use.fontawesome.com/releases/v5.14.0/js/all.js" data-auto-replace-svg></script>

  <!-- Load our stylesheet -->

<style>
table, th, td {
  border: 1px white;
  border-collapse: collapse;
}
table.center {
  margin-left:auto; 
  margin-right:auto;
}
text {
  position: top;
  text-align:center
}
</style>

  <!-- CSS only -->

  <link rel="stylesheet" type="text/css" HREF="../css/styles.css">
</head>

<body>

<!-- Code. -->


  <div><text><h1>YouTube Subscribers Trend - 2020 - Year 1 </h1></text></div>
   <div><text><h1>Quick Facts - {{ month_end_at }} Months of Activity</h1></text></div>
   <div><text><h1>Last Updated {{ one_month_ago.strftime('%m-%d-%Y') }}</h1></text></div>
  
<table class="center">

    <thead>

    <tr><b>

      <th> </th>

    </tr></b>

    </thead>

      <td></td><td><canvas id="subscribers" width="700" height="500"></canvas></td>
      <td></td><td><canvas id="subscribersquarterly" width="700" height="500"></canvas></td>
      <td></td><td><canvas id="subscribersannual" width="700" height="500"></canvas></td>
     </td>


  </table>
<!--   first month with data: {{ from_month }}
  last month with data: {{ to_month }}  
  months with data: {{ months }} 
  // helps retrieve month list to copy and paste into labels. Charts disappear when passed in. -->
  <script>
       
       
        
       
        // bar chart data

            var barData = {
                labels : ['April ', 'May ', 'June ', 'July ', 'August ', 'September', 'October ', 'November ', 'December '],
                datasets : [
                    {
                        fillColor : "#48A497",
                        strokeColor : "#48A4D1",
                        data : {{ subscribers }}
                    }
                ]
            }

            // get bar chart canvas

            var subscribers = document.getElementById("subscribers").getContext("2d");

            // draw bar chart

            var myBar = new Chart(subscribers).Bar(barData, {
                showTooltips: false,
                onAnimationComplete: function () {

                    var subscribers = this.chart.subscribers;
                    subscribers.font = this.scale.font;
                    subscribers.fillStyle = this.scale.textColor
                    subscribers.textAlign = "center";
                    subscribers.textBaseline = "bottom";

                    this.datasets.forEach(function (dataset) {
                        dataset.bars.forEach(function (bar) {
                            subscribers.fillText(bar.value, bar.x, bar.y - 5);
                        });
                    })
                }
            });

       // bar chart data

            var barDataQ = {
                labels : [ "Q1","Q2","Q3","Q4" ],
                datasets : [
                    {
                        fillColor : "#48A497",
                        strokeColor : "#48A4D1",
                        data : [ 0, {{ quarter2 }}, {{ quarter3 }}, {{ quarter4 }} ]
                    }
                ]
            }

            // get bar chart canvas

            var subscribersquarterly = document.getElementById("subscribersquarterly").getContext("2d");

            // draw bar chart

            var myBar = new Chart(subscribersquarterly).Bar(barDataQ, {
                showTooltips: false,
                onAnimationComplete: function () {

                    var subscribersquarterly = this.chart.subscribersquarterly;
                    subscribersquarterly.font = this.scale.font;
                    subscribersquarterly.fillStyle = this.scale.textColor
                    subscribersquarterly.textAlign = "center";
                    subscribersquarterly.textBaseline = "bottom";

                    this.datasets.forEach(function (dataset) {
                        dataset.bars.forEach(function (bar) {
                            subscribersquarterly.fillText(bar.value, bar.x, bar.y - 5);
                        });
                    })
                }
            });
       // bar chart data

            var barDataA = {
                labels : [ "YTD" ],
                datasets : [
                    {
                        fillColor : "#48A497",
                        strokeColor : "#48A4D1",
                        data : [{{ subscribers|sum() }}]
                    }
                ]
            }

            // get bar chart canvas

            var subscribersannual = document.getElementById("subscribersannual").getContext("2d");

            // draw bar chart

            var myBar = new Chart(subscribersannual).Bar(barDataA, {
                showTooltips: false,
                onAnimationComplete: function () {

                    var subscribersannual = this.chart.subscribersannual;
                    subscribersannual.font = this.scale.font;
                    subscribersannual.fillStyle = this.scale.textColor
                    subscribersannual.textAlign = "center";
                    subscribersannual.textBaseline = "bottom";

                    this.datasets.forEach(function (dataset) {
                        dataset.bars.forEach(function (bar) {
                            subscribersannual.fillText(bar.value, bar.x, bar.y - 5);
                        });
                    })
                }
            });

       </script>




<table class="center">

<tr>
  <td> <b>Monthly Goal (reached and exceeded December 2020):</b> </td><td> 82.50 subscribers </td>
  <td> <b>Monthly Count:</b></td><td> {{ subscribers }} </td>
</tr>
<tr>
  <td><b>Quarterly Goal:</b></td>  <td> 225 subscribers </td>
  <td><b>Quarter 1:</b> </td><td>{{ quarter1 }} </td>
  <td></td><td></td><td><b>Quarter 2:</b> </td><td>{{ quarter2 }} </td>
  <td></td><td></td><td><b>Quarter 3:</b> </td><td>{{ quarter3 }} </td>
  <td></td><td></td><td><b>Quarter 4:</b> </td><td>{{ quarter4 }} </td>
</tr>
<tr>
  <td><b>Annual subscribers:</b> </th> <td> {{ subscribers|sum() }} </td>
  <td><b>12 Consecutive Months Goal:</b> </td> <td> 1000 subscribers </td>
  </tr>
<tr>
   <td><b>Last 1 Month is after:</b> </th> <td> {{ one_month_ago.strftime('%m-%d-%Y') }}</td>
   <td><b>1 Month total:</b> </th> <td> {{ last_month }} </td>
   <td><b>1 Month goal:</b> </th> <td> 83.33</td>
   <td><b>1 Month variance:</b> </th> <td> {{ variance1 }}</td>
</tr>
<tr>
   <td><b>Last 3 Months is after:</b> </th> <td> {{ three_months_ago.strftime('%m-%d-%Y') }}</td>
   <td><b>3 Months total:</b> </th> <td> {{ three_months }} </td>
   <td><b>3 Month goal:</b> </th> <td> 250</td>
   <td><b>3 Month variance:</b> </th> <td> {{ variance3 }}</td>
<tr>
   <td><b>Last 6 Months is after:</b> </th> <td> {{ six_months_ago.strftime('%m-%d-%Y') }}</td>
   <td><b>6 Months total:</b> </th> <td> {{ six_months }} </td>
   <td><b>6 Month goal:</b> </th> <td> 500</td>
   <td><b>6 Month variance:</b> </th> <td> {{ variance6 }}</td>
</tr>
<tr>
   <td><b>Last 9 Months is after:</b> </th> <td> {{ nine_months_ago.strftime('%m-%d-%Y') }}</td>
   <td><b>9 Months total:</b> </th> <td> {{ nine_months }} </td>
   <td><b>9 Month goal:</b> </th> <td> 750</td>
   <td><b>9 Month variance:</b> </th> <td> {{ variance9 }}</td>
</tr>
<tr>
   <td><b>Last 12 Months is after:</b> </th> <td> {{ twelve_months_ago.strftime('%m-%d-%Y') }}</td>
   <td><b>12 Months total:</b> </th> <td> {{ twelve_months }} </td>
   <td><b>12 Month goal:</b> </th> <td> 1000</td>
   <td><b>12 Months variance:</b> </th> <td> {{ variance12 }}</td>
   <!-- <td><b>12 Months variance:</b> </th> <td>  </td> -->
</tr>
<tr>
   <td><b>1 Month Projection: Prior Months is after:</b> </th> <td> {{ eleven_months_ago.strftime('%m-%d-%Y') }}</td>
   <td><b>Prior Months total:</b> </th> <td> {{ eleven_months }} </td>
   <td><b>Last month, prior month, growth ratio, next month's projection, 11 months sum to use, new anticipated 12-month total, deficit, rough attainment timeframe:</b> </th> <td> {{ variance1g }} | {{ variance11 }} | {{ growthrate }} | <b>{{next_month_projected}}</b> | {{ month11p }} | {{next_month_projected_total}} | <b>{{ deficit }}</b> | <b>{{ rough_attainment_timeframe.strftime('%m-%d-%Y') }}  </b> </td>
   <!-- <td><b>12 Months variance:</b> </th> <td>  </td> -->
</tr>
 <tr>
   <td><b>Refreshed (UTC):</b> </th> <td> {{ current_time.strftime('%m-%d-%Y') }} </td><td>Variances from goal should shrink over the first year-and-a-half approximately. Goals were set to match the 1 year goal for hours but the 1000 subscribers could more realistically take an average active creator 17 months and the goal isn't a moving target like hours. </td>
</tr>
</table>

<!-- https://bugsdb.com/_en/debug/bcfd5a2be7b65020e534e29101bf2987, http://jinja.pocoo.org/docs/dev/templates/#sum, key is that our list does not contain a dictionary so we need to modify to not use an attribute. -->
<!-- a JSFiddle example with bars on chart http://jsfiddle.net/yobwf43d/-->

<!-- JS-based components. -->

<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

</body>

</html>